from rdkit.Chem import rdchem

# Format: (atom_symbol_1, atom_symbol_2, bond_type) -> (mean_length_in_angstroms, variance, median, N)
BOND_DATA = {
    ('C', 'C', 'AROMATIC'): (1.387976127, 0.00039818, 1.386690609, 2757532),
    ('C', 'C', 'SINGLE'): (1.513652002, 0.001039513, 1.517573768, 1832128),
    ('C', 'O', 'SINGLE'): (1.402727801, 0.002295398, 1.417532363, 525138),
    ('C', 'N', 'SINGLE'): (1.427376464, 0.002585456, 1.443052057, 436365),
    ('C', 'O', 'DOUBLE'): (1.213717452, 0.000365014, 1.212213455, 238325),
    ('C', 'N', 'AROMATIC'): (1.354956974, 0.000988602, 1.354676639, 207682),
    ('C', 'C', 'DOUBLE'): (1.338347344, 0.000913081, 1.335914571, 107479),
    ('C', 'S', 'SINGLE'): (1.780145861, 0.001235671, 1.771393186, 81459),
    ('C', 'F', 'SINGLE'): (1.341030726, 0.000610686, 1.34163343, 80583),
    ('C', 'Si', 'SINGLE'): (1.871455783, 0.000782913, 1.86943668, 54913),
    ('O', 'S', 'DOUBLE'): (1.433667492, 0.000329965, 1.43136037, 49510),
    ('C', 'Cl', 'SINGLE'): (1.745863876, 0.000800575, 1.74085201, 37406),
    ('C', 'N', 'DOUBLE'): (1.290709825, 0.00084834, 1.284546072, 34941),
    ('N', 'O', 'SINGLE'): (1.268906408, 0.007318, 1.226243785, 32075),
    ('C', 'P', 'SINGLE'): (1.825254807, 0.001008475, 1.822443623, 28912),
    ('C', 'S', 'AROMATIC'): (1.728957169, 0.000515642, 1.72958179, 27335),
    ('C', 'O', 'AROMATIC'): (1.372812119, 0.000321653, 1.373413467, 24866),
    ('Br', 'C', 'SINGLE'): (1.906794278, 0.001023245, 1.900012062, 23856),
    ('N', 'O', 'DOUBLE'): (1.220237415, 0.000293473, 1.221113271, 22473),
    ('N', 'N', 'AROMATIC'): (1.353113123, 0.001082981, 1.357143891, 21977),
    ('C', 'N', 'TRIPLE'): (1.141940746, 0.000156601, 1.142473304, 19487),
    ('N', 'S', 'SINGLE'): (1.644238105, 0.001285202, 1.639940011, 17686),
    ('N', 'N', 'SINGLE'): (1.386525367, 0.001183799, 1.386927905, 14826),
    ('B', 'C', 'SINGLE'): (1.597730881, 0.001626911, 1.596657271, 14011),
    ('O', 'P', 'SINGLE'): (1.589049507, 0.002748189, 1.577797224, 9654),
    ('B', 'N', 'SINGLE'): (1.529728403, 0.006233826, 1.544504442, 9163),
    ('N', 'P', 'SINGLE'): (1.652448351, 0.003013834, 1.650946742, 8810),
    ('C', 'C', 'TRIPLE'): (1.192247938, 0.000295333, 1.194637221, 8395),
    ('O', 'Si', 'SINGLE'): (1.641092535, 0.001119209, 1.640504718, 7639),
    ('B', 'O', 'SINGLE'): (1.417826428, 0.00448906, 1.386812781, 7522),
    ('C', 'S', 'DOUBLE'): (1.665814466, 0.000804827, 1.668450826, 6941),
    ('O', 'P', 'DOUBLE'): (1.475516167, 0.000396278, 1.475827419, 5599),
    ('C', 'I', 'SINGLE'): (2.105294621, 0.001354019, 2.099864771, 5192),
    ('N', 'N', 'DOUBLE'): (1.214610608, 0.004437636, 1.237848702, 5175),
    ('B', 'F', 'SINGLE'): (1.381618238, 0.000311899, 1.382059261, 4303),
    ('N', 'Si', 'SINGLE'): (1.758106226, 0.005536414, 1.742913515, 3654),
    ('O', 'S', 'SINGLE'): (1.57557673, 0.004437372, 1.581857034, 3338),
    ('Si', 'Si', 'SINGLE'): (2.369186629, 0.001309845, 2.362506087, 3089),
    ('N', 'O', 'AROMATIC'): (1.404277678, 0.000711312, 1.405614922, 2695),
    ('N', 'P', 'DOUBLE'): (1.579089113, 0.000757907, 1.579576649, 2542),
    ('Cl', 'P', 'SINGLE'): (2.034859079, 0.00532998, 2.008948665, 1823),
    ('P', 'S', 'DOUBLE'): (1.938619177, 0.000553039, 1.941139387, 1620),
    ('N', 'S', 'AROMATIC'): (1.637198813, 0.001526811, 1.620234986, 1609),
    ('S', 'S', 'SINGLE'): (2.06552652, 0.005106239, 2.052355398, 1512),
    ('B', 'P', 'SINGLE'): (1.944714292, 0.003098298, 1.929199114, 1165),
    ('N', 'S', 'DOUBLE'): (1.558369418, 0.002169853, 1.54963013, 1114),
    ('O', 'O', 'SINGLE'): (1.4704798, 0.002333004, 1.47183867, 952),
    ('F', 'S', 'SINGLE'): (1.575729702, 0.001394182, 1.579981911, 910),
    ('C', 'P', 'DOUBLE'): (1.707927925, 0.001952733, 1.70338426, 864),
    ('Cl', 'Si', 'SINGLE'): (2.070371129, 0.003560067, 2.054242773, 740),
} # Total crystals analyzed; 6,796,985

ATOMIC_SYMBOLS = {
    1: 'H',
    5: 'B',
    6: 'C',
    7: 'N',
    8: 'O',
    9: 'F',
    14: 'Si',
    15: 'P',
    16: 'S',
    17: 'Cl',
    35: 'Br',
    53: 'I',
}


def get_bond_data_from_key(key):
    """
    Returns a dictionary of bond statistics:
    - mean (float)
    - variance (float)
    - median (float)
    - count (int)
    Handles symmetric keys like ('C', 'O', type) == ('O', 'C', type)
    """
    data = BOND_DATA.get(key)
    if data is None:
        rev_key = (key[1], key[0], key[2])
        # print(f'====== Getting bond data from key {rev_key} and key is {key}=========')
        data = BOND_DATA.get(rev_key)
    if data is None:
        return None
    mean, var, median, count = data
    return {
        "mean": mean,
        "variance": var,
        "median": median,
        "count": count
    }